# 대용량 엑셀 다운로드 성능 및 동시 요청 안정성 개선 포트폴리오

**실무에서 발생한 OOM 문제** 해결 경험을 기반으로, **비동기 동시성 제어**를 적용하여 대용량 엑셀 다운로드의 **안정성**과 **처리 속도**를 획기적으로 개선한 프로젝트

📎 [GitHub Repository 바로가기](https://github.com/ji1007k/sb-excel-optimizer)

---

## 프로젝트 개요

- **배경**: 대용량 엑셀 다운로드(10만 건) 동시 요청 시 `OutOfMemoryError(OOM)` 발생 → 서비스 중단 및 다운로드 파일 손상
- **원인 분석**: 전체 데이터를 JVM 메모리에 적재하는 XSSF 구조
- **목표**: 메모리 안정화 및 동시성 제어로 **안정성과 처리 성능 극대화**

---

## 기술 스택

- Java 17
- Spring Boot 3 (Data JPA, Websocket)
- PostgreSQL
- Apache POI (XSSF, SXSSF)

---

## 개선 과정

### 1차: OOM 방지 및 메모리 안정화 (실무 조치)

- XSSF → SXSSF 스트리밍 전환, 일정 행만 메모리에 유지
- DB 페이징(1000건 단위)으로 순간 메모리 사용 최소화

### 2차: 성능 최적화 및 사용자 경험 개선 (포트폴리오)

- **비동기 처리**: 다운로드 요청 즉시 응답 및 `BlockingQueue` + `ThreadPoolExecutor` 기반 별도 워커 스레드에서 다운로드 처리 (WebSocket 알림)
- **커서 페이징**: `OFFSET/LIMIT` → `WHERE id > ? LIMIT ?`로 전환 → 조회 속도 개선 및 DB 부하 감소
- **디스크 안정성**: 임시 파일 정리 스케줄러 추가

### 3차: 라이브러리 성능 검증 (포트폴리오)

- FastExcel, EasyExcel, SXSSF 성능 비교 (50만 행 기준)
- 결과: 유의미한 성능 이점 확인 불가로 SXSSF 유지

📎 [라이브러리 비교 결과 바로가기](./docs/library-performance-analysis.md)

---

## 성과 **(10만 행 기준)**

- OOM 해결 및 **동시 요청 처리 안정화**
- **메모리 사용량 97.8% 절감** (832MB → 18MB)
- **처리량 10배 향상** (3.0개/분 → 32.3개/분)
- 즉시 응답 및 다운로드 완료 알림으로 **사용자 경험 향상**

📎 [성능 최적화 결과 바로가기](./docs/performance-test-results.md)

---

## 기술적 성장 및 배운 점

- **JVM 메모리 최적화**: OOM 발생 원인을 **JVM 및 GC 동작** 관점에서 분석하고, 스트리밍 + 커서 페이징 결합으로 **메모리 97% 절감** 달성 → 실질적인 문제 해결 역량 확보
- **비동기 아키텍처 및 동시성 제어**: **`BlockingQueue` 기반 작업 큐 시스템** 설계를 통해 동시 요청 부하에 안정적으로 대응 가능한 아키텍처 구현 역량 강화
- **DB 성능 개선**: `OFFSET/LIMIT` 성능 병목 인지 및 **커서 기반 페이징** 적용 → 대용량 조회 시 **DB 부하 감소 및 조회 성능 향상** 역량 습득

---

## 향후 개선 계획

- **분산 아키텍처 확장**: 인메모리 `BlockingQueue` 한계 → Redis Stream / RabbitMQ 전환으로 작업 영속성 확보
- **수평 확장 대응**: 다중 인스턴스 환경에서도 글로벌 동시성 제어 지원
