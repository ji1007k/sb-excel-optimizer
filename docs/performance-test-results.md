# **Excel 다운로드 성능 최적화 결과**

## **단계별 개선**

**STEP1: 실무 적용 (분할 처리)**

* SXSSF 기반 스트리밍 + 1000건 단위 청크 처리
* OOM 문제 해결, 메모리 절감(832MB → 110MB)
* 10만 행 기준 안정적 다운로드 가능

**STEP2: 개인 프로젝트 개선 (쿼리 최적화 + 비동기 큐)**

* 비동기 큐 + 스레드풀: 요청 즉시 응답, 동시 요청 안정성 확보
* 쿼리 최적화 (ROWNUM → ID 커서 페이징)
* 처리량 10배 ↑, 응답 지연 해소, 메모리 83% 절감

---

## **핵심 성과**

* **OOM 완전 해결** (50만 행 안정 처리)
* **메모리 사용량 97.8% 절감** (832MB → 18MB)
* **처리량 10배 향상** (3.0개/분 → 32.3개/분)
* **응답시간 19.1초 → 즉시(2ms)**, 사용자 경험 개선
* **동시 요청 처리 가능**, 시스템 안정성 확보

---

## **참고: 상세 분석 결과**

### **성능 분석 (10만 행 기준)**

| 측정 항목 | 전체 로딩 | 분할 처리 | 비동기 큐 | 개선 효과 |
|---------|--------|--------|----------|---------|
| 응답시간 | 15.6초 | 19.1초 | 즉시 (2ms) | 99.9% ↓ |
| 처리시간 | 15.6초 | 19.1초 | 3.0초 | 80.6% ↓ |
| 메모리 | 832MB | 110MB | 18MB | 97.8% ↓ |
| GC 시간 | 876ms | 5ms | 3ms | 99.7% ↓ |
| 처리량 | 3.2개/분 | 3.0개/분 | 32.3개/분 | 916% ↑ |

### **대용량 안정성 검증 (50만 행 기준)**

| 방식 | 처리 방식 | 응답시간 | 처리시간 | 분당 처리량 | 비고 |
|------|----------|----------|---------|------------|------|
| 전체 로딩 | 동기 | - | - | - | OOM으로 처리 불가 |
| 분할 처리 | 동기 (단일) | 6.2분 | 6.2분 | 0.18개 | 안정적이지만 순차 처리 |
| 비동기 큐 | 비동기 (3개 동시) | 즉시 (2ms) | 1.0분 | 0.96개 | 동시성 + 고성능 |

**테스트 환경**: OpenJDK 17, 1GB Heap, 각 시나리오별 5회 테스트 평균값