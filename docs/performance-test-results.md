# Excel 다운로드 성능 최적화 결과

## 단계별 개선

**STEP1: 실무 적용 (분할 처리)**

* SXSSF 기반 스트리밍 + 1000건 단위 청크 처리
* OOM 문제 해결, 메모리 절감(832MB → 110MB)

**STEP2: 개인 프로젝트 개선 (쿼리 + 비동기 큐)**

* 비동기 큐 + 스레드풀: 요청 즉시 응답, 동시 요청 안정성 확보
* 쿼리 최적화 (ROWNUM → ID 커서 페이징): 인덱스 활용으로 DB 성능 향상

**STEP3: 라이브러리 성능 검증**

* Apache POI, EasyExcel, FastExcel 3개 라이브러리 성능 비교
* 50만 행 기준 처리시간, 메모리, GC 성능 5회 반복 측정
* Apache POI SXSSF 스트리밍 대비 다른 라이브러리들의 큰 성능 우위를 확인하지 못함

---

## 성능 측정 결과

### 1. 아키텍처 개선 성과 (10만 행 기준)

| 측정 항목 | 전체 로딩 | 분할 처리 | 비동기 큐 | 개선 효과 |
|---------|--------|--------|----------|---------|
| 응답시간 | 15.6초 | 19.1초 | 즉시 (2ms) | 99.9% 감소 |
| 처리시간 | 15.6초 | 19.1초 | 3.0초 | 80.6% 감소 |
| 메모리 | 832MB | 110MB | 18MB | 97.8% 감소 |
| GC 시간 | 876ms | 5ms | 3ms | 99.7% 감소 |
| 처리량 | 3.2개/분 | 3.0개/분 | 32.3개/분 | 916% 증가 |

### 2. 대용량 안정성 검증 (50만 행 기준)

| 방식 | 처리 방식 | 응답시간 | 처리시간 | 분당 처리량 | 비고 |
|------|----------|----------|---------|------------|------|
| 전체 로딩 | 동기 | - | - | - | OOM으로 처리 불가 |
| 분할 처리 | 동기 (단일) | 6.2분 | 6.2분 | 0.18개 | 안정적이지만 순차 처리 |
| 비동기 큐 | 비동기 (3개 동시) | 즉시 (2ms) | 1.0분 | 0.96개 | 동시성 + 고성능 |

### 3. 라이브러리 성능 비교 (50만 행 기준)

| 라이브러리 | 처리시간 | 메모리 | GC시간 | 안정성 | 특징 |
|-----------|----------|-----------|--------|-------|----------|
| Apache POI | 97초 | 18MB | 3ms | 우수 | 스트리밍 |
| EasyExcel | 98초 | 92MB | 25ms | 양호 | 개발편의성 |
| FastExcel | 102초 | 338MB | 516ms | 주의 필요 | finish() 시점 일괄 쓰기 |

#### 핵심 발견사항
* **Apache POI (SXSSF)**: 스트리밍 기반으로 안정적이나, 임시 파일 관리 필요
* **EasyExcel**: 성능상 큰 차이는 없지만, 어노테이션 매핑 지원으로 개발 편의성 우수
* **FastExcel**: finish() 시점 일괄 처리 구조로 데이터가 많아질수록 메모리 사용량 급증

>  결론: 라이브러리 교체만으로는 SXSSF 대비 체감 성능 개선 효과가 제한적임을 검증
---

테스트 환경: OpenJDK 17, 1GB Heap, 각 시나리오별 5회 테스트 평균값
