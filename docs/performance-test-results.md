# Excel 다운로드 성능 최적화 결과

> 10만 행, 50만 행 기준 실측 데이터 비교 (5회 반복 테스트 평균)

---

## 테스트 환경

- OpenJDK 17
- Heap Size: 1GB
- 측정 방식: 각 시나리오별 5회 반복 평균
- 데이터: 10만 행/50만 행 컬럼 6개

---

## 성능 측정 결과

### 1. 아키텍처 개선 효과 (10만 행 기준)

| 전략                     | 응답시간 | 처리시간 | 메모리 | GC 시간 | 처리량 |
|------------------------|---------|---------|--------|---------|--------|
| XSSF 전체 로드             | 19.1초 | 19.1초 | 832MB | 1200ms | 3.0개/분 |
| SXSSF OFFSET 페이징       | 8.5초 | 8.5초 | 50MB | 200ms | 8.5개/분 |
| SXSSF CURSOR 페이징 (비동기) | 2ms | 3.0초 | 18MB | 80ms | 32.3개/분 |

**핵심 개선**
- 메모리 97.8%↓ (832MB → 18MB)
- 응답시간 99.99%↓ (19.1초 → 2ms)
- 처리량 977%↑ (3.0개/분 → 32.3개/분)
- GC 시간 93.3%↓ (1200ms → 80ms)

---

### 2. 대용량 안정성 검증 (50만 행 기준)

| 전략 | 처리 방식 | 응답시간 | 처리시간 | 분당 처리량 | 안정성 |
|------|----------|----------|---------|------------|--------|
| XSSF 전체 로드 | 동기 | - | - | - | OOM 발생 |
| SXSSF OFFSET 페이징 | 동기 (순차) | 6.2분 | 6.2분 | 0.18개 | 안정적 |
| SXSSF CURSOR 페이징 (비동기) | 비동기 (큐) | 2ms | 1.0분 | 0.96개 | 안정적 |

**결론**: CURSOR 페이징 + 비동기 처리로 대용량 데이터 다운로드 동시 요청도 안정적 처리 가능

---

### 3. 라이브러리 성능 비교 (50만 행 기준)

| 라이브러리 | 처리시간 | 메모리 | GC 시간 | 특징 |
|-----------|---------|--------|---------|------|
| Apache POI SXSSF | 97초 | 18MB | 3ms | 스트리밍, 메모리 효율 최고 |
| EasyExcel | 98초 | 92MB | 25ms | 어노테이션 매핑, 개발 편의성 |
| FastExcel | 102초 | 338MB | 516ms | finish() 일괄 쓰기, 메모리 급증 |

📎 [라이브러리 비교 결과 바로가기](./library-performance-analysis.md)

---