# 대용량 엑셀 라이브러리 (POI, EasyExcel, FastExcel) 비교

## 테스트 목적

* 대용량 Excel 생성 시 **성능 극대화** 및 **동시 처리 안정성 확보**를 위한 라이브러리 선정

## 테스트 환경

* OS: Windows 11, JVM: OpenJDK 17, Heap 1GB
* DB: PostgreSQL, 500,000 rows × 6 columns
* 각 라이브러리 5회 실행 후 평균값
* 공통 조건: 비동기 큐 3건 동시 처리, 1,000건 단위 청크 + ID 기반 커서 페이징

---

## 성능 테스트 결과 (5회 평균)

| 라이브러리        | 처리시간 | 메모리   | GC 시간 |
| ------------ | ---- | ----- | ----- |
| SXSSF[1]     | 97초  | 18MB  | 3ms   |
| EasyExcel[2] | 98초  | 92MB  | 25ms  |
| FastExcel[3] | 102초 | 338MB | 516ms |

---

## 메모리 처리 & 안정성 분석

| 라이브러리     | 메모리 처리 방식                                  | 대용량 안정성  | 동시 처리 안정성         |
| --------- | ------------------------------------------ | -------- | ----------------- |
| SXSSF     | rolling buffer + 임시 파일 flush               | 매우 안정적   | 안정적               |
| EasyExcel | POI 기반, 청크 단위 flush, DTO 오버헤드 있음           | 안정적      | 안정적               |
| FastExcel | Sheet 전체 Row/Cell 내부 버퍼 유지, finish 시 flush | 피크 발생 가능 | 다수 동시 요청 시 OOM 위험 |

**핵심 포인트**

* **SXSSF**: 청크 단위 처리 → 메모리 절약 극대화, GC 부담 최소
* **EasyExcel**: 오버헤드 있지만 안정적, 개발 편의성 높음
* **FastExcel**: finish() 시 Sheet 전체 로딩 → 메모리 급증, GC 부담 증가 → 동시 처리 시 위험

---

## 선택 가이드

| 라이브러리     | 특징 / 장단점                                       | 적합 용도                   |
| --------- | ---------------------------------------------- | ----------------------- |
| SXSSF     | 스트리밍 방식, 메모리 효율 최고, 레거시 호환/수식·차트·이미지 지원        | 대용량 안정성 최우선, 복잡 기능 필요   |
| EasyExcel | SAX 기반 이벤트 처리, DTO 매핑, 개발 편의성 우수, 단순 테이블 최적화   | 단순 테이블, 개발 편의성/읽기 속도 중요 |
| FastExcel | finish() 시 메모리 급증 가능, 멀티스레드 시트 작성 지원, 단순 쓰기 위주 | 소규모/단순 구조, 대용량 안정성 덜 중요 |

**결론**

* 대용량 다운로드: **SXSSF 유지**
* 단순 테이블 + 개발 편의성: **EasyExcel 고려 가능**
* 다수 동시 요청 환경: **FastExcel 사용 지양**

---

[1]: https://github.com/apache/poi
[2]: https://github.com/alibaba/easyexcel
[3]: https://github.com/dhatim/fastexcel

